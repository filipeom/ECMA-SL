(include_subdirs unqualified)

(library
 (name ECMA_SL)
 (wrapped false)
 (preprocess
  (staged_pps ppx_import ppx_deriving.std))
 (libraries batteries extlib menhirLib yojson z3)
 (modules :standard \ main generate_standard)
 (modules_without_implementation securityLevel securityMonitor topLevelM))

(executable
 (public_name ECMA-SL)
 (name main)
 (modules main)
 (libraries ECMA_SL))

(executable
 (public_name generate_standard)
 (name generate_standard)
 (modules generate_standard)
 (libraries ECMA_SL))

(subdir
 syntax/core
 (rule
  (target Lexer.ml)
  (deps Lexer.mll)
  (action
   (chdir
    %{workspace_root}
    (run %{bin:ocamllex} -ml -q -o %{target} %{deps}))))
 (menhir
  (modules Parser)
  (flags --table)))

(subdir
 syntax/extended
 (rule
  (target E_Lexer.ml)
  (deps E_Lexer.mll)
  (action
   (chdir
    %{workspace_root}
    (run %{bin:ocamllex} -ml -q -o %{target} %{deps}))))
 (menhir
  (modules E_Parser)
  (flags --table)))

(env
 (_
  (flags
   (-w +a-4-27-42-44-45-70 -warn-error +a-3))))
